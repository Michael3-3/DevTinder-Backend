const validate = require('validator');

const validateSingUp = (req,res,next)=>{
    if(!req.body.firstName || !req.body.email || !req.body.password ) {
        throw new Error("First name, email, and password are required.");
    }
    if(req.body.firstName.length > 50 || req.body.firstName.length < 2 || validate.isAlphanumeric(req.body.firstName) === false) {
        throw new Error("invalid first name");
    }
    if(!validate.isEmail(req.body.email)) {
        throw new Error("invalid email");
    }
    if(!validate.isStrongPassword(req.body.password)) {
        throw new Error("invalid password");
    }
    next();

}

module.exports = {
    validateSingUp}